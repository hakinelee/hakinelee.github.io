# STM32入门教程（标准库）

> 基于STM32F103C8T6最小系统板+面包板硬件平台



## 一、STM32介绍

- STM32是ST公司基于ARM Cortex-M内核开发的32位微控制器。

  > ARM既指ARM公司，也指ARM处理器内核。


- ARM公司设计ARM内核，半导体厂商完善内核周边电路并生产芯片。


![STM32与ARM]()

### STM32F103C8T6

![STM32F103C8T6]()

- 系列：主流系列STM32F1
- 内核：ARMCortex-M3
- 主频：72MHz
- RAM：20K（SRAM）
- ROM：64K（Flash）
- **供电：2.0~3.6V（标准3.3V）**
- 封装：LQFP48（48个引脚）


> RAM运行内存，实际的存储介质是SRAM
>
> ROM程序存储器，实际的存储介质是Flash闪存

> 51单片机使用的是5V供电，USB输出的电压也是5V，不在STM32F103C8T6的供电范围内，不能直接给STM32供电。如果使用5V电压，需要外加一个稳压芯片，把电压降到3.3V，再给STM32供电。

### 片上资源/外设/Peripheral

> 以下是STM32F1整个系列的所有外设，C8T6没有DAC/SDIO/FSMC/USB OTG。

| 英文缩写    | 名称                   | 英文缩写 | 名称               |
| ----------- | ---------------------- | -------- | ------------------ |
| **NVIC**    | **嵌套向量中断控制器** | CAN      | CAN通信            |
| **SysTick** | **系统滴答定时器**     | USB      | USB通信            |
| RCC         | 复位和时钟控制         | RTC      | 实时时钟           |
| GPIO        | 通用IO口               | CRC      | CRC校验            |
| AFIO        | 复用IO口               | PWR      | 电源控制           |
| EXTI        | 外部中断               | BKP      | 备份寄存器         |
| TIM         | 定时器                 | IWDG     | 独立看门狗         |
| ADC         | 模数转换器             | WWDG     | 窗口看门狗         |
| DMA         | 直接内存访问           | DAC      | 数模转换器         |
| USART       | 同步/异步串口通信      | SDIO     | SD卡接口           |
| I2C         | I2C通信                | FSMC     | 可变静态存储控制器 |
| SPI         | SPI通信                | USB OTG  | USB主机接口        |

> `NVIC` 与 `SysTick` 是位于Cortex-M3内核里的外设，其余是内核外的外设。

- NVIC  嵌套向量中断控制器，内核里面用于管理芯片的的设备，比如配置中断优先级等；

- SysTick  系统滴答定时器，内核里的一个定时器，主要用于给操作系统（FreeRTOS，UCOS等）提供定时服务，进行任务切换；也可用于实现Delay函数；

- RCC  复位和时钟控制，用于对系统的时钟进行配置，也用于使能各模块的时钟；

  > 在STM32中其他外设在上电的情况下默认是没有时钟的，不给时钟的情况下，操作外设是无效的，外设也不会工作，目的是降低功耗。所以在操作外设前，必须要使能它的时钟。

- GPIO通用IO口，可用GPIO点灯，读取按键等；

- AFIO复用IO口，可以用于复用功能端口的重定义，中断端口的配置等；

- EXTI外部中断，配置好外部中断后，当引脚有电平变化时，就可以触发中断，让CPU来处理任务；

- TIM定时器， 分为高级、通用、基本定时器三种类型，其中高级定时器最为复杂，常用的是通用定时器，不仅可以完成定时中断的任务，还可以完成测频率、生成PWM波形、配置成专用的编码器接口等功能；

- ADC模数转换器，STM32内置了12位的AD转换器，可以直接读取IO口的模拟电压值，无需外部连接AD芯片；

- DMA直接内存访问，可以帮助CPU完成搬运大量数据这样的繁杂任务；

- USART同步/异步串口通信，UART是异步串口，USART是既支持异步串口，又支持同步串口通信；

- I2C通信/SPI通信 ，常用的2种通信协议，STM32也内置了他们的控制器，可以用硬件来输出时序波形，也可以用通用IO口来模拟时序波形；

- CAN通信，常用于汽车领域的一种通信协议；

- USB通信，利用STM32的USB外设，可以制作模拟鼠标，模拟U盘等设备；

- RTC实时时钟，在STM32内部完成年月日、时分秒的计时功能，而且可以接外部备用电池，即时掉电也能正常运行；

- CRC校验，一种数据的校验方式，用于判断数据的正确性；

- PWR电源控制，可以让芯片进入睡眠模式等状态，来达到省电的目的；

- BKP备份寄存器，这是一段存储器，当系统掉电时，仍可由备用电池保持数据；

- IWDG独立看门狗/WWDG窗口看门狗，当单片机因为电磁干扰死机或程序设计不合理出现死循环时，看门狗可以及时复位芯片，保证系统的稳定；

- DAC数模转换器，可以在IO口直接输出模拟电压，是ADC模数转换的逆过程；

- SDIO，SD卡接口，用来读取SD卡；

- FSMC可变静态存储控制器，可以用于扩展内存，或者配制成其他总线协议，用于某些硬件的操作；

- USB OTG就是USB主机接口，用OTG功能可以让STM32作为USB主机去读取其他的USB设备。

### 5. 命名规则

![命名规则]()

### 6. 系统结构 

![系统结构]()





### 7. 启动配置 







## 二、软件安装及新建工程

### 2.1 软件安装

- Keil5 MDK
- STM32CubeMX
- VsCode
- FlyMCU + XCOM

### 2.2 型号分类及缩写

| 缩写  | 释义               | Flash容量 | 型号              |
| ----- | ------------------ | --------- | ----------------- |
| LD_VL | 小容量产品超值系列 | 16~32K    | STM32F100         |
| MD_VL | 中容量产品超值系列 | 64~128K   | STM32F100         |
| HD_VL | 大容量产品超值系列 | 256~512K  | STM32F100         |
| LD    | 小容量产品         | 16~32K    | STM32F101/102/103 |
| MD    | 中容量产品         | 64~128K   | STM32F101/102/103 |
| HD    | 大容量产品         | 256~512K  | STM32F101/102/103 |
| XL    | 加大容量产品       | 大于512K  | STM32F101/102/103 |
| CL    | 互联型产品         | -         | STM32F105/107     |

### 2.3 新建工程步骤

- 建立工程文件夹，Keil中新建工程，选择型号；
- 工程文件夹里建立Start、Library、User等文件夹，复制固件库里面的文件到工程文件夹；
- 工程里对应建立Start、Library、User等同名称的分组，然后将文件夹内的文件添加到工程分组里；
- 工程选项，C/C++，IncludePaths内声明所有包含头文件的文件夹；
- 工程选项，C/C++，Define内定义`USE_STDPERIPH_DRIVER`；
- 工程选项，Debug，下拉列表选择对应调试器，Settings，FlashDownload里勾选Reset and Run。

### 2.4 工程架构







## 三、GPIO输入输出口







## 四、OLED调试工具















更新中❗❗❗



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
<div class="social-share"></div>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

